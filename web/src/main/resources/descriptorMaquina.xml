<?xml version="1.0" encoding="UTF-8"?>

<zkib-model>
	<datanode name="maquines">
		<finder name="maquina" type="maquina">
			<ejb-finder jndi="java:comp/env/ejb/XarxaEJB" method="findMaquinaByFiltre"
				if="${queryEnabled}"> <!-- host:query -->
				<parameter value="${nom}" />
				<parameter value="${so}" />
				<parameter value="${ip}" />
				<parameter value="${dhcp}" />
				<parameter value="${correu}" />
				<parameter value="${ofimatica}" />
				<parameter value="${alies}" />
				<parameter value="${mac}" />
				<parameter value="${descripcio}" />
				<parameter value="${xarxa}" />
				<parameter value="${usuari}" />
				<parameter value="${restringeixCerca}" />
			</ejb-finder>
			<new-instance-bean className="es.caib.seycon.ng.comu.Maquina">
			</new-instance-bean>
		</finder>

		<finder name="osTypeCriteria" type="osTypeCriteria">
			<script-finder>
				obj = new es.caib.seycon.ng.comu.OsType();
				obj.name = "";
				return obj;
			</script-finder>
			<ejb-finder jndi="java:comp/env/ejb/XarxaEJB" method="findAllOSType"> <!-- os:query -->
			</ejb-finder>
			<new-instance-bean className="es.caib.seycon.ng.comu.OsType">
			</new-instance-bean>
		</finder>

		<finder name="osType" type="osType">
			<ejb-finder jndi="java:comp/env/ejb/XarxaEJB" method="findAllOSType"> <!-- os:query -->
			</ejb-finder>
			<new-instance-bean className="es.caib.seycon.ng.comu.OsType">
			</new-instance-bean>
		</finder>
	</datanode>

	<datanode name="maquina">
		<ejb-handler jndi="java:comp/env/ejb/XarxaEJB">
			<insert-method method="create" returnBean="true">
				<parameter value="${instance}" />
			</insert-method>
			<delete-method method="delete">
				<parameter value="${instance}" />
			</delete-method>
			<update-method method="update">
				<parameter value="${instance}" />
			</update-method>
		</ejb-handler>
		<finder name="xarxes" type="xarxa">  <!-- host:query -->
			<ejb-finder jndi="java:comp/env/ejb/XarxaEJB" method="getXarxes">
			</ejb-finder>
		</finder>
		<finder name="sessio" type="sessio">
			<ejb-finder jndi="java:comp/env/ejb/XarxaEJB" method="findSessionsByNomMaquina">  <!-- host:query -->
				<parameter value="${instance.nom}" />
			</ejb-finder>
			<new-instance-bean className="es.caib.seycon.ng.comu.Sessio">
			</new-instance-bean>
		</finder>
		<finder name="alies" type="alies">
			<ejb-finder jndi="java:comp/env/ejb/XarxaEJB" method="findAliasByNomMaquina">  <!-- host:query -->
				<parameter value="${instance.nom}" />
			</ejb-finder>
			<new-instance-bean className="es.caib.seycon.ng.comu.AliasMaquina" />
		</finder>
		<finder name="accesComAdministrador" type="accesComAdministrador">
			<ejb-finder jndi="java:comp/env/ejb/XarxaEJB"
				method="findAutoritzacionsAccesMaquinaComAdministradorByHostAndDataPeticio"> <!--host:admin:query -->
				<parameter value="${instance.nom}" />
				<parameter value="${dataPeticio}" />
				<parameter value="${dataCaducitat}" />
			</ejb-finder>
			<new-instance-bean className="es.caib.seycon.ng.comu.AutoritzacioAccesHostComAdministrador" />
		</finder>
		<finder name="accesComAdministradorNoCaducat" type="accesComAdministrador">
			<ejb-finder jndi="java:comp/env/ejb/XarxaEJB"
				method="findAutoritzacionsAccesMaquinaComAdministradorByHostAndDataPeticio"> <!--host:admin:query -->
				<parameter value="${instance.nom}" />
				<parameter value="" />
				<parameter value="hui" />
			</ejb-finder>
			<new-instance-bean className="es.caib.seycon.ng.comu.AutoritzacioAccesHostComAdministrador" />
		</finder>
		<validator>
			<attribute-validator expr="${instance.nom}" notNull="true" friendlyName="hosts.nameValidation2"/>
			<attribute-validator expr="${instance.sistemaOperatiu}" notNull="true" friendlyName="hosts.OSValidation2"/>
		</validator>
	</datanode>

	<datanode name="xarxa" />

	<datanode name="sessio" />

	<datanode name="alies">  <!-- host:update, host:create i host:delete -->
		<ejb-handler jndi="java:comp/env/ejb/XarxaEJB">
			<insert-method method="create" returnBean="true">
				<parameter value="${instance}" />
			</insert-method>
			<delete-method method="delete">
				<parameter value="${instance}" />
			</delete-method>
			<update-method method="update">
				<parameter value="${instance}" />
			</update-method>
		</ejb-handler>
	</datanode>

	<datanode name="accesComAdministrador" />

	<datanode name="osType">  <!-- os:create, os:delete i os:update -->
		<ejb-handler jndi="java:comp/env/ejb/XarxaEJB">
			<insert-method method="create" returnBean="true">
				<parameter value="${instance}" />
			</insert-method>
			<delete-method method="delete">
				<parameter value="${instance}" />
			</delete-method>
			<update-method method="update">
				<parameter value="${instance}" />
			</update-method>
		</ejb-handler>
		<validator>
			<attribute-validator expr="${instance.name}" notNull="true" friendlyName="hosts.nameValidation"/>
		</validator>
	</datanode>

	<datanode name="osTypeCriteria" />

</zkib-model>
